<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Coger Agri Admin Dashboard</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- jsPDF libraries for PDF export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

<style>
  /* CSS Variables and Themes */
  :root {
    --green: #2d5016;
    --light-green: #4a7c2c;
    --sage: #7fb069;
    --brown: #8b7355;
    --yellow: #f4a259;
    --bg: #f8f9f0;
    --white: #fff;
    --dark: #2c3e1f;
    --red: #d9534f;
    --orange: #f0ad4e;
    --success: #5cb85c;
  }
  body {
    font-family: Arial, sans-serif;
    background: var(--bg);
    color: var(--dark);
    margin: 0;
    display: flex;
    min-height: 100vh;
  }
  body.dark-theme {
    --green: #90ee90;
    --light-green: #6bbf6b;
    --sage: #a3d9a5;
    --brown: #5a4a3b;
    --yellow: #f0e68c;
    --bg: #121212;
    --white: #eeeeee;
    --dark: #e0e0e0;
    --red: #f08080;
    --orange: #f4a259;
    --success: #4caf50;
    background: var(--bg);
    color: var(--white);
  }
  /* Sidebar */
  .sidebar {
    width: 260px;
    background: linear-gradient(180deg, var(--green), var(--light-green));
    color: white;
    position: fixed;
    top: 0; left: 0;
    height: 100vh;
    overflow-y: auto;
    padding-top: 20px;
    box-sizing: border-box;
  }
  .sidebar .logo {
    font-size: 26px;
    font-weight: bold;
    padding: 20px 0;
    text-align: center;
    user-select: none;
    border-bottom: 1px solid rgba(255,255,255,0.2);
  }
  .menu-item {
    padding: 15px 25px;
    cursor: pointer;
    border-left: 4px solid transparent;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s;
    user-select: none;
  }
  .menu-item:hover,
  .menu-item.active {
    background: rgba(255, 255, 255, 0.1);
    border-left-color: var(--yellow);
  }
  /* Main content */
  .main {
    margin-left: 260px;
    padding: 20px 30px;
    flex: 1;
    overflow-y: auto;
    background: var(--bg);
    min-height: 100vh;
    box-sizing: border-box;
  }
  /* Top bar */
  .top-bar {
    background: white;
    padding: 15px 25px;
    border-radius: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    user-select: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    margin-bottom: 20px;
  }
  body.dark-theme .top-bar {
    background: #222;
    box-shadow: 0 2px 12px rgba(255,255,255,0.1);
    color: var(--white);
  }
  /* Buttons */
  .btn-primary, .btn-warn, .btn-success, .btn-danger {
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    color: white;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  .btn-primary { background-color: var(--light-green);}
  .btn-primary:hover { background-color: var(--green);}
  .btn-success { background-color: var(--success);}
  .btn-danger { background-color: var(--red);}
  .btn-warn { background-color: var(--orange);}
  .btn-warn:hover { background-color: #cf8c46; }
  /* Toast */
  .toast {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--green);
    color: white;
    padding: 15px 25px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease-in-out;
    z-index: 10000;
  }
  .toast.show {
    opacity: 1;
    pointer-events: auto;
  }
  /* General section container */
  .section {
    display: none;
  }
  .section.active {
    display: block;
    animation: fadeIn 0.3s ease;
  }
  /* Tables */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }
  table th, table td {
    border: 1px solid #ccc;
    padding: 8px 10px;
    text-align: left;
    vertical-align: middle;
  }
  body.dark-theme table th,
  body.dark-theme table td {
    border-color: #555;
  }
  /* Form Controls */
  .search, select, input[type="text"], input[type="number"], input[type="date"], textarea {
    padding: 8px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 6px;
    font-size: 14px;
    box-sizing: border-box;
  }
  .search:focus, select:focus, input[type="text"]:focus, input[type="number"]:focus, input[type="date"]:focus, textarea:focus {
    outline: none;
    border-color: var(--sage);
  }
  /* Responsive */
  @media (max-width: 768px) {
    .main {
      margin-left: 0;
      width: 100%;
    }
    .sidebar {
      width: 100%;
      height:auto;
      position: relative;
    }
    .top-bar {
      flex-direction: column;
      gap: 10px;
    }
  }
  @keyframes fadeIn {
    from {opacity: 0;}
    to {opacity: 1;}
  }
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar" role="navigation" aria-label="Primary sidebar">
  <div class="logo">ðŸŒ¾ Coger Agri</div>
  <div class="menu-item active" data-section="dashboard" tabindex="0">ðŸ“Š Dashboard</div>
  <div class="menu-item" data-section="products" tabindex="0">ðŸ“¦ Products</div>
  <div class="menu-item" data-section="orders" tabindex="0">ðŸ›’ Orders</div>
  <div class="menu-item" data-section="customers" tabindex="0">ðŸ‘¥ Customers</div>
  <div class="menu-item" data-section="analytics" tabindex="0">ðŸ“ˆ Analytics</div>
  <div class="menu-item" data-section="finances" tabindex="0">ðŸ’° Finances</div>
</div>

<div class="main" role="main" tabindex="0">

  <div class="top-bar">
    <div class="title">Admin Dashboard</div>
    <div>
      Admin User ðŸŒ±
      <button id="themeToggleBtn" class="btn-warn" aria-pressed="false" aria-label="Toggle dark mode">ðŸŒ™ Dark Mode</button>
    </div>
  </div>

  <!-- Dashboard -->
  <div id="dashboard" class="section active" tabindex="0">
    <h2>Welcome to Coger Agri Admin Dashboard</h2>
    <p>This is your dashboard overview.</p>
    <ul>
      <li>Total Products: <span id="dashboardTotalProducts"></span></li>
      <li>Total Orders: <span id="dashboardTotalOrders"></span></li>
      <li>Total Customers: <span id="dashboardTotalCustomers"></span></li>
      <li>Monthly Sales (â‚¹): <span id="dashboardMonthlySales"></span></li>
    </ul>
  </div>

  <!-- Products -->
  <div id="products" class="section" tabindex="0">
    <h2>Product Management</h2>
    <input type="text" id="productSearch" placeholder="Search products..." class="search" />
    <table id="productsTable">
      <thead>
        <tr><th>Image</th><th>Name</th><th>Category</th><th>Price</th><th>Stock</th></tr>
      </thead>
      <tbody id="productsList"></tbody>
    </table>
  </div>

  <!-- Orders -->
  <div id="orders" class="section" tabindex="0">
    <h2>Order Management</h2>
    <input type="text" id="orderSearch" placeholder="Search orders..." class="search" />
    <table id="ordersTable">
      <thead>
        <tr><th>Order ID</th><th>Customer</th><th>Total</th><th>Status</th></tr>
      </thead>
      <tbody id="ordersList"></tbody>
    </table>
  </div>

  <!-- Customers -->
  <div id="customers" class="section" tabindex="0">
    <h2>Customer Management</h2>
    <input type="text" id="customerSearch" placeholder="Search customers..." class="search" />
    <table id="customersTable">
      <thead>
        <tr><th>Name</th><th>Email</th><th>Orders</th><th>Total Spent</th></tr>
      </thead>
      <tbody id="customersList"></tbody>
    </table>
  </div>

  <!-- Analytics -->
  <div id="analytics" class="section" tabindex="0">
    <h2>Sales Analytics</h2>
    <canvas id="salesChart" height="150"></canvas>
  </div>

  <!-- Finances -->
  <div id="finances" class="section" tabindex="0" style="outline:none;">
    <h2>Financial Overview</h2>

    <!-- User Role Selection -->
    <div style="margin-bottom: 15px;">
      <label for="roleSelect">Current User Role: </label>
      <select id="roleSelect" style="padding:6px; min-width: 150px;">
        <option value="admin" selected>Admin</option>
        <option value="accountant">Accountant</option>
        <option value="viewer">Viewer</option>
      </select>
    </div>

    <!-- Summary Widgets -->
    <div id="financeWidgets" style="display:flex; gap: 20px; margin-bottom: 15px; flex-wrap: wrap;">
      <div class="finance-widget" style="flex:1; min-width:150px; background:var(--sage);color:#fff; padding:15px; border-radius:10px;">
        <strong>Total Expenses:</strong> <span id="widgetTotalExpenses">â‚¹0.00</span>
      </div>
      <div class="finance-widget" style="flex:1; min-width:150px; background:var(--light-green);color:#fff; padding:15px; border-radius:10px;">
        <strong>Total Returns:</strong> <span id="widgetTotalReturns">â‚¹0.00</span>
      </div>
      <div class="finance-widget" style="flex:1; min-width:150px; background:var(--yellow);color:#000; padding:15px; border-radius:10px;">
        <strong>Profit / Loss:</strong> <span id="widgetProfitLoss">â‚¹0.00</span>
      </div>
      <div class="finance-widget" style="flex:1; min-width:150px; background:var(--brown);color:#fff; padding:15px; border-radius:10px;">
        <strong>ROI %:</strong> <span id="widgetROI">0.00%</span>
      </div>
    </div>

    <!-- Profit/Loss Button -->
    <div style="margin-bottom: 15px;">
      <button id="profitLossBtn" class="btn-primary" style="font-size:16px; padding:10px 30px; width: fit-content;">
        Profit/Loss: â‚¹0.00
      </button>
    </div>

    <!-- Filters & Currency -->
    <div style="display:flex; align-items:center; gap:20px; margin-bottom: 10px; flex-wrap: wrap;">
      <label for="monthFilter">Select Month: </label>
      <input type="month" id="monthFilter" />

      <label for="currencySelect" style="white-space: nowrap;">Currency: </label>
      <select id="currencySelect" style="padding:6px;">
        <option value="INR" selected>â‚¹ INR</option>
        <option value="USD">$ USD</option>
        <option value="EUR">â‚¬ EUR</option>
        <option value="GBP">Â£ GBP</option>
      </select>
    </div>

    <!-- Budget Limits -->
    <div style="margin-bottom: 15px;">
      <h3>Budget Limits (per category)</h3>
      <div id="budgetLimitsContainer" style="display:flex; flex-wrap: wrap; gap: 10px;"></div>
    </div>

    <!-- Add Expense Form -->
    <div style="margin-bottom: 20px; border:1px solid var(--light-green); box-shadow: 0 2px 12px rgba(74,124,44,0.2); padding:20px; border-radius:16px; max-width:750px; background: var(--white); color: var(--dark);">
      <h3 style="margin-bottom: 15px; color: var(--green); font-weight: 700;">Add New Expense</h3>
      <form id="addExpenseForm" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); grid-gap: 16px; align-items: end;">
        <div>
          <label for="expenseDate" style="display:block; font-weight:600; margin-bottom:4px;">Date</label>
          <input type="date" id="expenseDate" required style="width:100%; padding:10px; border: 2px solid var(--sage); border-radius: 8px; font-size: 14px;" />
        </div>
        <div style="position:relative;">
          <label for="expenseCategory" style="display:block; font-weight:600; margin-bottom:4px;">Category</label>
          <input type="text" id="categorySearch" placeholder="Search categories..." style="width:100%; padding:8px 10px; border:2px solid var(--sage); border-radius:8px; font-size:14px; margin-bottom:6px;" autocomplete="off" />
          <select id="expenseCategory" required style="width:100%; padding:10px; border: 2px solid var(--sage); border-radius: 8px; font-size: 14px; cursor: pointer;">
            <option value="" disabled selected>Select Category</option>
            <optgroup label="Core Business">
              <option value="Processing">Processing</option>
              <option value="Labor">Labor</option>
              <option value="Maintenance">Maintenance</option>
            </optgroup>
            <optgroup label="Operations">
              <option value="Travel">Travel</option>
              <option value="Transport">Transport</option>
              <option value="Packaging">Packaging</option>
              <option value="Utilities">Utilities</option>
            </optgroup>
            <optgroup label="Marketing & Sales">
              <option value="Marketing">Marketing</option>
            </optgroup>
            <option value="Other">Other</option>
          </select>
        </div>
        <div>
          <label for="expenseAmount" style="display:block; font-weight:600; margin-bottom:4px;">Amount</label>
          <input type="number" id="expenseAmount" min="0" step="0.01" required style="width:100%; padding:10px; border: 2px solid var(--sage); border-radius: 8px; font-size: 14px;" placeholder="â‚¹0.00" />
        </div>
        <div style="grid-column: span 2;">
          <label for="expenseNotes" style="display:block; font-weight:600; margin-bottom:4px;">Notes</label>
          <input type="text" id="expenseNotes" placeholder="Optional notes" style="width:100%; padding:10px; border: 2px solid var(--sage); border-radius: 8px; font-size: 14px;" />
        </div>
        <div style="display:flex; flex-direction: column; align-items: center;">
          <label for="recurringExpense" style="font-weight:600; margin-bottom:6px;">Recurring?</label>
          <input type="checkbox" id="recurringExpense" style="width: 20px; height: 20px;" />
        </div>
        <div>
          <label for="expenseAttachment" style="display:block; font-weight:600; margin-bottom:4px;">Receipt (Image)</label>
          <input type="file" id="expenseAttachment" accept="image/*" style="width:100%; padding:6px; border: 2px solid var(--sage); border-radius: 8px; font-size: 14px;" />
        </div>
        <div style="display:flex; justify-content:flex-end; align-items:center;">
          <button type="submit" class="btn-primary" style="min-width: 120px; padding:12px 24px; font-weight: 700; font-size: 16px; border-radius: 8px;">Add Expense</button>
        </div>
      </form>
      <div id="attachmentPreviewContainer" style="margin-top:10px;"></div>
    </div>

    <!-- Expenses Table -->
    <table id="expenseTable" style="width:100%; margin-bottom:20px;">
      <thead>
        <tr>
          <th>Date</th>
          <th>Category</th>
          <th>Amount (â‚¹)</th>
          <th>Notes</th>
          <th>Recurring</th>
          <th>Receipt</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="expenseLogBody"></tbody>
    </table>

    <!-- Export Buttons -->
    <div style="margin-bottom:20px;">
      <button id="exportExpensesCSV" class="btn-primary">Export Expenses CSV</button>
      <button id="exportSummaryCSV" class="btn-primary" style="margin-left:10px;">Export Summary CSV</button>
      <button id="exportPDF" class="btn-primary" style="margin-left:10px;">Export PDF Report</button>
    </div>

    <!-- Charts -->
    <canvas id="expensesPieChart" height="200" style="margin-bottom: 30px;"></canvas>
    <canvas id="budgetBarChart" height="200"></canvas>

    <!-- Notifications -->
    <div id="financeNotification" role="alert" style="position: fixed; bottom: 20px; right: 20px; background: var(--yellow); color: black; padding: 12px 20px; border-radius: 10px; display:none; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index:10000;"></div>
  </div>

</div>

<script>
  // Core data and functions are included below...

  // This snippet is limited due to message size,
  // For full JavaScript including all handlers, charts and exports,
  // please refer to the previous full code messages or ask to provide separately.
</script>

</body>
</html>
